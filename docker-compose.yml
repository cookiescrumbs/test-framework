version: '3.7'
services:
    frontend: 
      build: 
        context: .
        dockerfile: frontend.Dockerfile
      ports:
        - 3000:3000
      depends_on:
        - "backend"
      volumes: 
        - ${PWD}/frontend:/frontend
        # use the node_modules from inside the container and not from local machine
        - /frontend/node_modules
      command: npm run start
  
    backend: 
      build: 
        context: .
        dockerfile: backend.Dockerfile
      environment: 
        ENV: 
      ports:
        - 3001:3001
      volumes: 
        - ${PWD}/backend:/backend
        # use the node_modules from inside the container and not from local machine
        - /backend/node_modules
      command: npm run start

    api-tests:
      build: 
        context: .
        dockerfile: api-tests.Dockerfile
      environment: 
        API_BASE_URL: 'http://backend:3001'
      volumes:
        - ${PWD}/api-tests:/api-tests
        # use the node_modules from inside the container and not from local machine
        - /api-tests/node_modules
      depends_on:
          - backend
    

    
